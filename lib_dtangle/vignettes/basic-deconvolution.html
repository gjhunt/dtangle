<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Gregory Hunt" />

<meta name="date" content="2017-02-14" />

<title>Basic Deconvolution</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Basic Deconvolution</h1>
<h4 class="author"><em>Gregory Hunt</em></h4>
<h4 class="date"><em>2017-02-14</em></h4>



<p>We can show a basic deconvolution example by working with a data set created from rats. This is available on GEO with accession <a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE19830">GSE19830</a>.</p>
<p>First let’s download the data set and read it in using the <code>affy</code> package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rat.url &lt;-<span class="st"> &quot;ftp://ftp.ncbi.nlm.nih.gov/geo/series/GSE19nnn/GSE19830/suppl/GSE19830_RAW.tar&quot;</span>
rat.dir &lt;-<span class="st"> &quot;rat_data&quot;</span>
<span class="kw">dir.create</span>(rat.dir, <span class="dt">showWarnings =</span> <span class="ot">FALSE</span>)
rat.file &lt;-<span class="st"> &quot;rat.tar&quot;</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">download.file</span>(rat.url, <span class="dt">destfile =</span> rat.file)
<span class="kw">untar</span>(rat.file, <span class="dt">exdir =</span> rat.dir)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">suppressPackageStartupMessages</span>(<span class="kw">library</span>(<span class="st">'affy'</span>))
rat &lt;-<span class="st"> </span><span class="kw">ReadAffy</span>(<span class="dt">celfile.path =</span> rat.dir)</code></pre></div>
<p>This is a data set of rat brain, liver and lung cells that have been mixed together in various proportions and then analyzed with by DNA microarrays. The true mixing proportions are encoded in the following matrix.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rat.truth =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.25</span>,<span class="fl">0.25</span>,<span class="fl">0.25</span>,<span class="fl">0.05</span>,<span class="fl">0.05</span>,<span class="fl">0.05</span>,<span class="fl">0.7</span>,<span class="fl">0.7</span>,<span class="fl">0.7</span>,<span class="fl">0.25</span>,<span class="fl">0.25</span>,<span class="fl">0.25</span>,<span class="fl">0.45</span>,<span class="fl">0.45</span>,<span class="fl">0.45</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.3</span>,<span class="fl">0.3</span>,<span class="fl">0.3</span>,<span class="fl">0.3</span>,<span class="fl">0.3</span>,<span class="fl">0.3</span>,<span class="fl">0.4</span>,<span class="fl">0.4</span>,<span class="fl">0.4</span>,<span class="fl">0.35</span>,<span class="fl">0.35</span>,<span class="fl">0.35</span>,<span class="fl">0.34</span>,<span class="fl">0.34</span>,<span class="fl">0.34</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.05</span>,<span class="fl">0.05</span>,<span class="fl">0.05</span>,<span class="fl">0.7</span>,<span class="fl">0.7</span>,<span class="fl">0.7</span>,<span class="fl">0.25</span>,<span class="fl">0.25</span>,<span class="fl">0.25</span>,<span class="fl">0.7</span>,<span class="fl">0.7</span>,<span class="fl">0.7</span>,<span class="fl">0.45</span>,<span class="fl">0.45</span>,<span class="fl">0.45</span>,<span class="fl">0.55</span>,<span class="fl">0.55</span>,<span class="fl">0.55</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.55</span>,<span class="fl">0.55</span>,<span class="fl">0.55</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.6</span>,<span class="fl">0.6</span>,<span class="fl">0.6</span>,<span class="fl">0.65</span>,<span class="fl">0.65</span>,<span class="fl">0.65</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">0.7</span>,<span class="fl">0.7</span>,<span class="fl">0.7</span>,<span class="fl">0.25</span>,<span class="fl">0.25</span>,<span class="fl">0.25</span>,<span class="fl">0.05</span>,<span class="fl">0.05</span>,<span class="fl">0.05</span>,<span class="fl">0.05</span>,<span class="fl">0.05</span>,<span class="fl">0.05</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.25</span>,<span class="fl">0.25</span>,<span class="fl">0.25</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.15</span>,<span class="fl">0.15</span>,<span class="fl">0.15</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.05</span>,<span class="fl">0.05</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>,<span class="fl">0.01</span>,<span class="fl">0.01</span>),<span class="dt">ncol=</span><span class="dv">3</span>,<span class="dt">byrow=</span><span class="ot">FALSE</span>)
<span class="kw">head</span>(rat.truth)</code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    0    1    0
## [2,]    0    1    0
## [3,]    0    1    0
## [4,]    1    0    0
## [5,]    1    0    0
## [6,]    1    0    0</code></pre>
<p>Each row is a sample and each column gives the mixing proportions of the cell type. From this we can extract out the pure samples of each of the three cell types.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pure_samples &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span>:<span class="dv">3</span>, function(i) {
    <span class="kw">which</span>(rat.truth[, i] ==<span class="st"> </span><span class="dv">1</span>)
})
pure_samples</code></pre></div>
<pre><code>## [[1]]
## [1] 4 5 6
## 
## [[2]]
## [1] 1 2 3
## 
## [[3]]
## [1] 7 8 9</code></pre>
<p>Now the deconvolution algorithm can work with many different types of data. Ultimately we just need a matrix of expressions for each experiment. Let’s first look at the probe level data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Y &lt;-<span class="st"> </span><span class="kw">log2</span>(<span class="kw">t</span>(affy::<span class="kw">intensity</span>(rat)))
Y[<span class="dv">1</span>:<span class="dv">4</span>,<span class="dv">1</span>:<span class="dv">4</span>]</code></pre></div>
<pre><code>##                         1        2        3        4
## GSM495209.CEL.gz 6.392317 12.30578 7.129283 12.30635
## GSM495210.CEL.gz 6.321928 12.12767 7.129283 12.11764
## GSM495211.CEL.gz 6.507795 12.37123 7.169925 12.33901
## GSM495212.CEL.gz 6.700440 12.50581 7.339850 12.52086</code></pre>
<p>Each row is a different experiment and each column is the log expression measurement of a particular oligonucleotide.</p>
<p>Here is an example of how to run the deconvolution method. First we ask to find the marker genes. We pass in the data matrix, <code>Y</code>, the list of pure samples for each type, <code>pure_samples</code>, the data type, <code>data_type</code>, and the method used to rank markers, <code>method</code>, to the function <code>find_markers</code>. The default <code>method</code> is “eta”.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">'deconv'</span>)
marker_list =<span class="st"> </span><span class="kw">find_markers</span>(Y,pure_samples,<span class="dt">data_type=</span><span class="st">&quot;microarray-probe&quot;</span>,<span class="dt">method=</span><span class="st">'eta'</span>)</code></pre></div>
<p>The function <code>find_markers</code> returns a list of two elements. The first is <code>L</code> which is a list of the same length as <code>pure_samples</code> with the <span class="math inline">\(i^{th}\)</span> element being markers for the <span class="math inline">\(i^{th}\)</span> type ranked in decreasing order of importance (best markers listed first). The second element of the list <code>find_markers</code> returns is a list of the same structure named <code>V</code>. This list contains the computed value for each marker that was used to rank the markers. The meaning of this value depends on the choice of <code>method</code>. For <code>method=eta</code> the values in <code>V</code> are the negative of the ratio of the estimated amount the particular marker is expressed in all other types to the amount that the marker is expressed in the <span class="math inline">\(i^{th}\)</span> type.</p>
<p>After we have ranked our markers we need to determine how many markers to use for each cell type. One way to do this is to threshold the values in <code>V</code> such that we only use a marker if the computed value is above a certain threshold. For example, we can set our threshold at <code>.005</code> so that we only keep markers if they are expressed in the cell type they mark at an estimated 200 times higher than how much they are expressed in all other cell types combined.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">thresh =<span class="st"> </span>.<span class="dv">005</span>
K =<span class="st"> </span><span class="kw">length</span>(pure_samples)
n_choose =<span class="st"> </span><span class="kw">sapply</span>(<span class="dv">1</span>:K,function(i){<span class="kw">max</span>(<span class="kw">which</span>(marker_list$V[[i]] &gt;<span class="st"> </span>(-thresh)))})</code></pre></div>
<p>for this example the number we choose to keep for each cell type is assigned to <code>n_choose</code>,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n_choose</code></pre></div>
<pre><code>## [1] 100 414 105</code></pre>
<p>Now that we have ranked our markers for each type and chosen how many to use for each type we can run the deconvolution algorithm.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">marks =<span class="st"> </span>marker_list$L
dc &lt;-<span class="st"> </span><span class="kw">deconv</span>(Y,pure_samples,n_choose,<span class="dt">data_type=</span><span class="st">'microarray-probe'</span>,<span class="dt">full_markers=</span>marks)</code></pre></div>
<p>providing to the <code>deconv</code> function <code>Y</code>, our microarray data, the list of <code>pure_samples</code>, the <code>data_type</code>, the number of top markers to use for each cell type, <code>n_choose</code>, and the list of ranked markers for each type to the <code>full_markers</code> argument.</p>
<p>The <code>deconv</code> function returns to us a list with elements <code>estimates</code>, the estimated mixing proportions for each type for each sample, <code>markers</code>, the markers used for each cell type, <code>n_choose</code>, how many markers we used for each cell type, and <code>gamma</code>, the value of the sensitivity parameter used.</p>
<p>We can plot our estimates against the known truth as follows</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">phats &lt;-<span class="st"> </span>dc$estimates
<span class="kw">plot</span>(rat.truth,phats,<span class="dt">xlab=</span><span class="st">&quot;Truth&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Estimates&quot;</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))
<span class="kw">abline</span>(<span class="dt">coef=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAeAAAAHgCAMAAABKCk6nAAADAFBMVEUAAAABAQECAgIDAwMEBAQFBQUGBgYHBwcICAgJCQkKCgoLCwsMDAwNDQ0ODg4PDw8QEBARERESEhITExMUFBQVFRUWFhYXFxcYGBgZGRkaGhobGxscHBwdHR0eHh4fHx8gICAhISEiIiIjIyMkJCQlJSUmJiYnJycoKCgpKSkqKiorKyssLCwtLS0uLi4vLy8wMDAxMTEyMjIzMzM0NDQ1NTU2NjY3Nzc4ODg5OTk6Ojo7Ozs8PDw9PT0+Pj4/Pz9AQEBBQUFCQkJDQ0NERERFRUVGRkZHR0dISEhJSUlKSkpLS0tMTExNTU1OTk5PT09QUFBRUVFSUlJTU1NUVFRVVVVWVlZXV1dYWFhZWVlaWlpbW1tcXFxdXV1eXl5fX19gYGBhYWFiYmJjY2NkZGRlZWVmZmZnZ2doaGhpaWlqampra2tsbGxtbW1ubm5vb29wcHBxcXFycnJzc3N0dHR1dXV2dnZ3d3d4eHh5eXl6enp7e3t8fHx9fX1+fn5/f3+AgICBgYGCgoKDg4OEhISFhYWGhoaHh4eIiIiJiYmKioqLi4uMjIyNjY2Ojo6Pj4+QkJCRkZGSkpKTk5OUlJSVlZWWlpaXl5eYmJiZmZmampqbm5ucnJydnZ2enp6fn5+goKChoaGioqKjo6OkpKSlpaWmpqanp6eoqKipqamqqqqrq6usrKytra2urq6vr6+wsLCxsbGysrKzs7O0tLS1tbW2tra3t7e4uLi5ubm6urq7u7u8vLy9vb2+vr6/v7/AwMDBwcHCwsLDw8PExMTFxcXGxsbHx8fIyMjJycnKysrLy8vMzMzNzc3Ozs7Pz8/Q0NDR0dHS0tLT09PU1NTV1dXW1tbX19fY2NjZ2dna2trb29vc3Nzd3d3e3t7f39/g4ODh4eHi4uLj4+Pk5OTl5eXm5ubn5+fo6Ojp6enq6urr6+vs7Ozt7e3u7u7v7+/w8PDx8fHy8vLz8/P09PT19fX29vb39/f4+Pj5+fn6+vr7+/v8/Pz9/f3+/v7////isF19AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAgAElEQVR4nO2dCXgT1dqAzyRN2qQ7pWnTfUX2fZNFKIushXrZKSKCVgGpIEvVe6XiiqL3ll/hWhEryL4rKosiKJsKCoiCUERF4CpQCi3QQkvmzyRNmrSZJJOZM5k5+d7HZzJz5uQ7h7w2meXM+RANEA3ydgcAvIBgwgHBhAOCCQcEEw4IJhwQTDggmHBAMOGAYMIBwYQDggkHBBMOCCYcEEw4IJhwQDDhgGDCAcGEA4IJBwQTDggmHBBMOCCYcEAw4YBgwgHBhAOCCQcEEw4IJhwQTDggmHBAMOGAYMIBwYQDggkHBBMOCCYcEEw4IJhwQDDhgGDCAcGEA4IJBwQTDggmHBBMOCCYcEAw4YBgwgHBhAOCCQcEEw4IJhwQTDggmHBAMOGAYMIBwYQDggkHBBMOCCYcEEw4IJhwQDDhgGDCAcGEA4IJBwQTDggmHBBMOCCYcEAw4YBgwgHBhAOCCQcEE47Agp9qB4hBq8gTuAQbrpcY2Pd2LjoM4Gd9XIOjWAQX56X5I6ROmXOGTfBBTvEAj9gZ9UHLY27W5ST4u5CYnILlyxZOSQz93nENECwChdF7aDyCe/YoN69UDu3luAYIxk51bvOzNCbBIe9Z1raGOq4BgnFTNrjfNRqX4A7ZluOrGR0d1wDBmPm1aU4V84pH8Dqq95L9J04eeH+wYr3jGiAYL/v1b5lX8AimP8lAJjI+YakAgrGySv9FzRomwTR95djOnUevsO4GwRgx5KdaL29gE1xDeanjchCMjxtZ3S5ZN3AL7m33vuI8C+GbPIsHuOL6+3FDbtdu4hb8xiTbrT/nW/B/27N4gAteoIyHPsGnrNu4BbMRtETYeICZZcyhLYWUdy0FIJgoDEqknvL2fRR61lICgkmi8kFE3TG+bkLhliIQTBCXu49EIaY1pLaU4RE80wbHNUCw8PyYlGdAVLVxbRdqYCnEI3hWOGqQWoPjGiBYcLbpVtC0Pwp4c9sohJ6zlGL6ij6tXOC8AggWmoLY74zLReZLxMpqSzGu3+AuIFhUqqa0/MO0MpkynggHfmPdgUvwV8ed7wfBglKSMfB6zeqlNx/bYjMYDo6iSaD4nty7LLtAMAF8HlXEug8Ey593o3ez7wTBcqc6r9EpJ7tBsMwpy+zLcsvdDAiWN2eb5dxxWgEEy5oDMQtd1ADBcma1jm1QoxUQLF8M+ak/u6wEgmVLxZiuf7uuBYLlyoX2E2+7rgWC5cqRxHy36oFgebJBt9m9iiBYlhTEH3azJgiWIZXjO/3P3bogWH5cuW/ETbcrg2DZcTw5j+3mrwNAsNzYrvuQS3UQLDMKo7/mVB8Ey4qqqS1+5/YOECwnrvYacN11LTtAsIwobsw6to4VECwf9uoXc38TCJYNS6K+9OBdIFgmVOel/+LJ+0CwPCgf0sfp2DpWQLAs+LONi7F1rIBgOXAwZr6nbwXBMmCNbqvH7wXBkseQn/KT5+8GwVKnYmwXN8bWsQKCJc7FDqMr+LwfBEubo26OrWMFBEuajTq+c3qCYClTEHeIbwisgktPsA7NBsGuuf1Q63O8g2AS/NHQ/ivod9RInV/tuAIIdsmVHsPdH1vHCh7Ba1CHwaqZwS99lqd8x3ENEOyKU424jK1jBY/gVuMM9Gr0qnHtiZaOa4BgF+zQLRMkDh7BmhXGH2C0x7i2Wuu4Bgh2TmH0V8IEwiM4PY+mv0KMwxcaOa4Bgp1RNa35bwKFwiP4NeVjz+m66Xde3hDyjOMaINgJZQP7XxMqFh7BVXNjGs4w5CCEBt1wXAMEs3OmSS7LuYcHYDsPNhj/27PsMFsKYRDMyj69kAlLvJU3CQSzsTRql5DhxM2bdHlJYQ0B//UsHukY8tNOChpQ3LxJx3MsqP7jWTzCKR/a/bKwEeFmg5Q43/YRD8fWsYJPsOF6CdsRFg2CHfJNrMdj61jBJLg4L80fIXXKnDMsFUBwfdbpPhY+KB7B34XE5BQsX7ZwSmLo945rgOC6GOYn/IAhLB7BPXuUm1cqh/ZyXAME16Ey+96/cMTFIzjkPcva1lDHNUCwPRc7jrqFJTAewR2yLcdXMzo6rgGC7TiWlO/kiJQPeASvo3ov2X/i5IH3ByvWO64Bgm35TLcSV2hMR9GfZJgzcGWwzWcMgm0oiPsOW2xs58FXju3cefQK624QbOX2hFZ/4IsOV7K8TUnPYQKMrWMFBHuZ0+xJywQBBHuXnVEf4G0ABHuVwug9mFsAwV6kOrf5WdxtgGDvUTa4n2Bj61gBwV7j16Y5VfhbAcHeYr/+LTGaAcFeYpX+C1HaAcFewZCfekKclkCwN7iR1e2SSE2BYC9wvt0kd5KWCQIIFp8jCfniNQaCRWe9bouIrYFgkTHMj2cZh4gHECwulQ92djtpmSCAYFG53H0knrF1rIBgMfkxKQ/T2DpWQLCIbNOtEL1NECweBbH4xtaxAoLFompKS4xj61gBwSJRkjGQa9IyQQDB4lCMeWwdKyBYFD6PKvJSyyBYDN6N3u2tpkEwfqrz0k+Z104ufdfdz1soQDB2yjLvN88lVTU5dsLEpDHiXsoCwbg528yStCz/3o4aTauMKaI2D4IxcyBmoWW1QWh0VGzDBlrRbvYzgGC8rNZZH6CtoKL20vT3yQpRr3eAYJwY8lN/tm7cQRuZl+9RsZhdAMEYufFAV5ukZbfQTOZlAXVEzD6AYHxcaD/R9ue2mkocvGzlyFiFWAMqTYBgbBypm7SsZdjj48ZM1sWJ2gucgqtOX2S9vU2+4A26zXVKvglP0WgTw3eI2g08gqtfHUZXzdUgFMd2h5t4wQXxh+uVnciKCBtQvxgreATPQ7PofL8ZH2/MNh851odwwZXjO4k7to4VPILjp9C0Pp9Zm9DecQ2yBV+5bwTOiVW44Ilg4w/r6U+dzlsdvpSuVn/GrH0Y5LgG0YKPJwuStEwQuAs+13ci/Y0ShTv7LRk8qJruPodZe9AHpzLcrvvQ212ohbvgrMgV9AMZv/bo76Ty8Yj7Vq7UPvX51jGI5SiLYMGF0V97uws2cBcc/m+6TLGJfifCWe1fHg02TWXYkm0ORmIFV01t8bu3+2ALd8GhhfRm5VV6SaDz+pVn9n3y7TmfOw++2muAk7F1e1958XPx+mKCu+C+nfZ36EWXZLRz620+ljepuLGTsXW3MrQqVWA7lk8EE9wFH41C2n10qnqrW2+zz5t0+7AFLZGC9+oXO9k7MmBs1tDswAzRusPgwWnSzUOXaHqDm/e87PMm7WtnQfm6uz2UEUuivnS22y9qzIZNkyIVFWL1h8GjCx13fr/J9xkqAr+iq/PSf3G2vxw9lOynjH2ckvrzwR+mKdCRh190pdjX8iaVD+nj/Nf1NlIM+HLvcAX6UaQemeAueCUa/RE68o6iwFlt38ub9GebHBdJyypQPPN/fGsk6mkUd8HNxhs3jtCzGzup7Ht5kw7GuExadgepQsLDwlRIpBmyzHAXrFljErxW46Syz+VNWqNzfVJRjvwaqNRhKkrUG4bcBbfONQl+rqWTyj6WN8mQn/KTG9UUzcIbN45oh0SYgrQW7oKXUHk/oR1LtQudVPatvEkVY7v87boWXa1UxD6QlaJQC5xA1jncBRveCEUIaec6O4r2qbxJFzuMduvM9rZSz1ye12nO4+6RLdwFl1aXfbN+f+kdp3NZ+1DepKN1x9axolBMKFr6hJK6gbM7deEuuGbc9hfBzuv7St6kjbpNbtasQOGHaPrnWEmfJq0eOhT1HsqQnsarXVIEF8QdYt1XOj3Jv/Vy609ZJVoYl5IetRBJ+UrWxuxsNCSbYdI+Xu2SIbjyodbnWHeWNerSKr5joxmW7Vso+86Z01XTqaOi9K0G7l/Rndj/SRwgQvCVHsOdjK17sUFyiH90ZJD1Yp62UcvnX+7YyE/U8Voej6o8uoBXuyQIPtXI6di6ewKeuWw40kX5b0vB88pxc2Y/onpMhK7Vwl3w3RWzZxppF8OrXQIE79Atd7o/sC2zvKEcbi15OUChUM/C26u6cBc8F7Xwj+oQyPMJDPkLLoz+ynkFTTdmeUeVWVtU9ctPLu5ICA53wYmT6ZWD6Uvp23i1K3fBVdOa/1a37PaWN1bZPDkYp3m7mv57uOpZEbtVH+6CVavoizoDXdCVV7syF1w2sH+9Cz2H0vvOHBVVOyR6WkDr4JTg1v7uXKbGB3fB0fk0HXWMXuZiVKUL5C34TJPc6rplN+KYpwlP6q2Pd1+KiolrGxo3StSe1YO74JzwJfTAiecy03m1K2vB+/Rv1y9cP9D08mquteSPkdqwhq+KOuVKfbgLvj4piz6qRcpVvNqVs+ClUbsclL5hmqCB/tjmmIquEvVhfod4eB58bSfPvKjyFWzITzvpqHzZaNPLokdE7Y1LPBBcefqkCV7tylZw+dDuju/n/h3JHE1dbyzuA/wu4S54baD5TiC/STvkKvh820fYzmTX6uasmp8wW9TuuIa74ISOG4+b4NWuTAUfjHUytu5w75TOzi9ueQEPHj7bLkS78hS8Tvcx+85Nutz358X+S7zeuAV3wZkvC9GuHAUb5if8wL73ciRzG/Bqujhpgd2Gu+C/Ep5cu5mBV7syFFyZfe9fTnYvH3nhpQefPvz2o6J1yC24C16MfPMg62LHUU5nel4wRDdj+UvxwzOdVRIf7oKTs36uMsGrXdkJPpaU7/xprCVq5pmja5FZ4vTHXbgL1u8Uol25Cf5MxzYZhYVCzafG5ZnQB8TojvtwF5w7XYh2pS/4ZtH0Zdbv5II4l0nLFoxNHvTcQ7pc2X9FF8X1n/cqA692JS94eYC/Xs08h2Xk9oRWrifxXjfo1toX3v/fa9Nw94wb3AWnWuDVrtQFn1Lm3qWrHlMyY5hLeg5zY9668ljmHPm03smZlDeA6YQdMyx1Tb8mAzYkZBuduZm07JvU/s+O032Au2ccAcGOaZHU4eMTm9sktaV3RrnrrGLDy8vceQpNVDgKfug1eoEFXu1KXXCzQOaBspuaNoXRe7zdF15wFIx604kWeLUrdcF9lcwzgL8rUprzvPHtbTgKLr9Fl5pHIzl/utAlUhc8NVY96b2H1ZpE9n/m7fz7+v1X7IztnMH2dKELpC540Zh5cRq9Lpm9mz8F+Wm1yjivJAXmADxdWMP1qS172zysfi2+0LBfPyKJ/VneCEqhUCipe0XoGx988+nCkn2n6wx73aKkQgNQeu0F9hPdIv11PU+xhjiL1AVrNjxNUbj6KBC++HRh2WMhjWPvsTs4rlYmltL0Gqr2QrJhbsIStkm+GArRIP3wwbpOAp8+Cg6eKf1d403B9yfE3NsmIsx2zNHblOmy8yC1peBGVjfnQ15fQcPKafpCKnmC3ZnSv4Y7m1n/N/Ci4OP+jfWZHRuoGn1aewg81mz2PcsX7vl2k1wMWP8IdTF+y98II0+wO1P611CKdrPt8qLgV5Uzbt/6R5IqoGM36xwizypMsicrzZtHEvJdRTmOqLAhff0V5Al2Z0r/bDMjUJ/sbMc1vCj4QeVdevaAwWrUa8xIS1kpGmNcXlY3M22t121x8L4tOcNfr51u9IKWUhpPk6gQ3N3lCZ4p/XuhoK5GOqHmXVkeQvSi4FzF73RExH/b+K/Ra8sthZNRWP92ChVzKdkwP97BNCmV3bVKtX/oQWtB+4dDFAr9SIk9yFAPPFP6310cNL5Eql/R65Sxy6l5Y7Rp9F5V7bTmOxL8gwcwdwUrx3V2lLRshrLhk3O6q0OtN5Z+iJ6+ZcOoxpK7u1AHXFP6n82I/kiigq8FhzZFSSkNX6crqPrP31zuPtLh2LrASJ2fStWTqk2Zc+WffTPfFHX2dk/ANqX/3UWB485IUjC9LLILatisWwX9T+1vdff9mJTn+PIyRamHPhxPUSJPscEbjPeDz2aES1Mw/eMEbaju/n4tmuvq3snfpmNLl4r8md/rx9ATmPsmNBwF/9N4+HF7G3N2+1Erl2+5u3Qm67UgL1+L3qyN7Nw5TvtmneKCWNaxdUhj/LW9Ox1J/aCqLlzvBxcZf6UQk9ypyL0/aYnmTcrr3jhCn9B/tF1h1ZSWdmPr7L6rKUXQ6CdS1UjcWa74g1twb5ZqXhas/5W+cpG+GVJuU1aSMdDm3t+t55P9Ul6uPYZS6zR+Sq0OsU2fK1VwC7bPm/QlsvIah04KTrWf+TXN5lCx2G5s3d0ebZtFNm/d1/pXPI7Kmj1lWoBG8nf464BbMBte/guONN0Sqwyp/ZP9PKrItsKGBs3axrVtEm79g63uQKmUCs03YvVQKPAJlnTepNwJzF/r3KHWgnejd9tVyNJ23fH7tk4am1/pbWMHvCL50956YBIs9bxJ5X06vPbv3m0u1mxW56XXubWfFsLcTaoIbCp2z4SGq+DAiIhwFBwRERHoTLAM8iZtnTNjtWVUR1nm/XUP9pN0ppcG/GYDkwAcBT9pg5PK8sqbdLZZ/aRlPQNmlNPXnwjo540OCQmeK1myypt0IMZBhqD/C2yvjQ9sF/Re/V3yAo9gOeVNWq1zdGpbHtcyrGloyySnD/XLATyCpZc36daqmQ6ndzbkp/7s8A3FfaLaRA2Q+WMNNLabDVLLmzRXgZQo8EC98hsPdGW9ofvn3gtY+yQO2O4meTdv0sVHugzfXbu5AaU3j2wfoqx7LHWh/UQvTwaLHTIfH33bT9+tiaL2Mka0qlVieHoKVefI/4jbScvkC5GC/6fsERyr7al8y1Kg9PPv/3grFWV/2WKDjt9cX7KASMGz1a30gaHtNdarFBTFHC19gBJtaxXEi5rI10sQKThDEa9Gfnp/raVAoWAeOtqHbP6CK8d3cjS2jjiIFNwBUd3eyPajrA+iaCj/GesyKSrDWuXyfSPcmFiFAIgU3BE9/HjXUYVIaSlo5K9XIFWa3/OWguPJTpOWEQSRguMRUjRQI0phKViqbNywZXC66mrN9nbdhyxvJQ4iBaeiqB5Nu7ZHVsH0OHVYckCAZcRkYfRejK1LCyIFt0bNUtT6DpRfbdG3j/d/ruaaVdXUFqKmaPYuRArOQqG6kJBE5HAakau9Bkh9Xg0hIVLwk+H+yI+iGjmaRqS4sXvz1pECkYKLlQXLs+d/rX6h/q69+sUYG5YgRAqmZ6vSxtyralMvvyC9JOpLnO1KEDIF06+EKbWZ9a5kVOel/4K1WQlCpuA5rT776/DIDpX2peVD+rA8SEMwRAo+Hb2sW2TrFwYtsiv9s039sXXkQ6TgJc1io/1DU5Ps0iccjHGStIxciBQ81y/jOH1pVkATm7I1OudTEpAKkYInKEyPmMRFWksM+SnezbTuNYgUPCpwcjltKAqyCq4Y20Xqk6XggkjBM8InhbSN7pphGdFxscNo+T01JhBECj6kefTi9xeXap82bx71gbF1rBApmM5KCmodmRhjvv27UbcJZ1sShxDBpdv22E7dXfGcVq3K/NO0XhB3SNCmZAYRgqszKYpSTK0t2BTgHxGsYGY8qnyotSDzW8sWIgR3pUYd3N2DetyyXeoXnPn8I6HUKvpKj+G+MbaOFRIEVyDTYLr+1jF2eYrPjMtzASmnGvnK2DpWSBC8GZkeVr2ILJeaO5mHcgxS65YL14pMIUTwlV37yi4gS0qNrkGml6aUwydGfQsSBFegbiHJieFNrGPs3qQ+oumqR6h7hGtDtpAgmI5FCpUfhXpYtks1iq5PRVPq7QK2IVdIEFypVCmMp0nK2ulAPg2PUGhC/yVcE/KFBMFH0KG/t+26tgjVjsH6NKRr/lHhWpAxJAjeaD6K/st6FE0vjdolXHh5Q4Lg42gt8zIb1UztY8hPqz9Vv6+CS3DVWfMVpBssD+EKKdjgr8k/tH+qv968WT60O8+0bCSBR3D1PA1ST2e+MReIMV/0YlVkfGKY2jzk+XzbR3xwbB0reAQvpHLXT1cyObFEEUxvT/VTtTZPyHAw1ifH1rGCR3BT5s5OEdoklmCavlNzBL1O97GwgeUOHsGa1cxyWEqFaILNGOYn/IAjrozBI/ie6czyz7CJBkyCz3/vaAKzyux7/+IVlkDwCH6Dytlyi6bXokmTcQheHUIpFFmVdYsvdhwl+7lDBQeP4KpXwxBzKrpOhzAI3qroNqRHZnD7OsXHkvLlljFDBHCdBxvOmwaq3v7iXcf7+QhODh+wac+8iDqJBz/TrfQ8JLngvpKFIzGWsgezPKB4ybawII41aZlPg1uwfWKsve0sKF73LB6D4kXTi9JmlN3tCa3+YKnt4+AWbJ8Y684Ph2vQ8vgL9jf9+n6HlllLSnoO8/GxdazI8WZDF0Xv45de9w+wpuw5fY9vTazCBXyC8SXG2h4TS1GaNoMt2zujljmr7ttgEow3MVZRdO8H4oeX1GwVRu/hEYt08AjGnRjr2s61ltlUqnObyz9zBkbwCBYvMVbZoH7XhIlEKDJPjPVr05wq17V8GXknxtqvf8t1Jd9G1omxVum/ECAK2cg4MZYhP/UE7yDEI4vEWJtb61ptrFt4I6vbJY598kXkcCWrD6IoCmXYF55vN4n0pGWCIAPBaxEKbRaK0ArbwiOJMLbOLWQgWI8KjMv/Q1E2Zet1W4TtD7HIQLDS/FioqjbFhmF+PMsFMqAuMhJsnaGhclxnn0haJggyEKxHbxqX/7F+RV/uPhLG1rmNDASvMx5ktTAeZK0yb/6YlAdj69xHBoLp+02nSb3NG9t0K5zXBuyQg2D6kzaRbT4yrxbEwtg6TshCsJWqKS1hbB03ZCW4JGOgLyUtEwQ5CS6GsXXckZHgz6OKhO2DTyAfwe9G7xa2C76BNAXXv09UnZd+Stge+AhSFPwghZDGfh6kssz7fS9pmSBIUHCyeTCI7ViQs818MWmZIEhP8K8I+SFKhWzSdx+IWShs6z6E9AR3R6jJCzkamyfHV+vYRnYBLpGe4Ibo2RVzXjngZ2kQxtbxQnqCY1DSoNeeSVTWNHjjga6+mrRMEKQn+B+IitVGWCb3uNB+Ioyt44P0BL9lPohGFLNxJCFf2HZ9DukJ3mLWi5gROht0m4Vt1veQnuBZKAgpKCrC+BdcEH9Y2FZ9EOkJnkS9s2H8s4cbUZXjO8HYOt5IT/BilD5owTOJaX73jYCJVfgjPcE3FcnvzHplgSLA55OWCYL0BNPz/RS6YIp6W9gGfRUJCqZ3t9MEa+DqpDBIUTBdNbXF78I257tIUfDVXgNgbJ1QSFBwcWMYWyccEhFcuejhFTUPpOzVLxa2Kd9GGlMZvqygVEi1jlldEvUl15YAJ0hiKsM9aICBvtWE+psZW/cLyzsAj5DEVIZpDUwvqsHlQ/rC2DphkcJUhodUUZ8yr0nxbWBsndB4fyrDu2nM7cHQEpoO84OJVQTH+1MZNjbf39fQr6McLm0AbuH9qQyNbr8NMBpOQjouTQDu4f2pDJkB0NW9KIRGcWoBcA/vT2WI/mVcXGyPWH6sAX54P28SUtP00cQ4VDeRGSAI4uZNOjbCguo/1sBI00cbghBM3I4FcfMmlayzkGC9IBln/rX2q/9eQAC8dbOh80HLWmU44zdc2PCABW/dbLAKvtJj+M1D22FqM1x462aDRfBPKTC2DiveutlQI3iHbjmXuABnvHWzwSy4MPorLmEB7njrZgMjuGpai9+4RAU8wFs3G4yCywb2h3Nf7HjrZkPng2ea5FZziQl4hLduNnQu1MOjC2LgrZsNaYFPFVp5ZtA4vgzO4h3i/pG8Q/TK5h0ig3eEMf8otCHWS1eyJo7OqaVteBO+NIjiHSIwgXcIVRrfCPcoeHciOcjmo83JdfcZAoEF27F4Mu8QTxbwDtFvO+8QibyfuLml4d2JI609ehsIdgMQ7BgQbAUEswCCrYBgFkAwNkCwFRDMAgi2AoJZAMHYWDKNd4iZi3iHGLTLdR0XpJ7nG6GS/+jh456NT8Up+HYZ7xDllbxDXOU/tIT90qz0Q+AUDEgAEEw4IJhwQDDhgGDCAcGEA4IJBwQTDggmHBBMOCCYcEAw4eAQvL5TaK9DDjc8ClH9ZhNt87c4Py5Rp+G7vbJ59YI+ntkg4QWuNy5sI1QtaKRts5ZzJ2h61kzHPXILDII/UYxd0j202MGGZyFepXJXTabm8QlBM1lfOAu2C/FLw4HvTUYc5+yzi5CvnP1hNtrKtRd0cQOrYA8+TQyCM3oZ6DJ9noMNj0IYwh81Lqdpqnj0gqbPBgVxFmwX4tH7jN8hM4fxiBDzmPEf0z6LYye+6uaHrII9+DSFF3wFvWtc5qTV3/AsxHm0xbhcj856HsL4BZ3xYFeugu1CVAavpDn/SthFMDR8zrgc3J9jjOMLFlj/gj35NIUXfAztNy4L/A31NjwLUXHylnE5Xc0tnVadhhdFl3AWbBfiV7Syuzr2eW5fI/admB719bU1qg859sJIqkWwJ5+m8IJ3Iibx83J0vd6GZyFMFCmf5NEL+mzgFpqzYLsQ+5B21qdz/eby6MTdbgihpzh2gsEq2JNPE4fgk8blMnSl3oZnIYycH47Gckw3bBfiboZRrgeCbUJ8gmYYl9O1nP6E7SIYHosu3P1y8Dsce0HbCeb+aQov+Cg6YFwuVBvqbXgWgqbXhaVs4tWLpeFnSks7jSjlNi25XYhv0efG5cfotMcRvkI7jMuX1NynP7AK9uTTxHGQVWRcTk2pv+FZCOPx1cQKfr2YWZOcmlvWYrsQ50znNxvRRY8jLEOXjcvPTN+y3EitPciyiecmGE6Teg42HnQmzXaw4VGI27pJnsynZhvizG4jzfvsvux5CEPLMcbluDhuXbGNcAhtNC6fVnNPbW8V7MmnieNCB/XUJ1mhZ2j6jd7ltRseh9iFJi9guMGjFwycf4PtQ6xE41dMRCs8j2AYEPLSmmlKbodpJsyCPfw0cVyqXNs+JIPJ8T0JldZueBzi3ZrvV65Zpe16QXsi2D7Ehx2C2rJMPeNehPKn0zXNF3kwQyOdLXkAAAGHSURBVI1ZsIefJtxsIBwQTDggmHBAMOGAYMIBwYQDggkHBBMOCCYcEEw4IJhwQDDhgGDCAcGEA4IJBwQTDggmHBBMOCCYcEAw4YBgwgHBhAOCCQcEEw4IJhwQTDi+J3hUzaMw6EX78o2raTpxgXf6hBHfE7ynqKgopqNxcdS+PHsoCCaGZqPql4FggjALTlz1XIPiwCLj2qR+dCfjl3Zp4uvzUkOGlXi3c8Li04J7peaWWASfG9K7uDox5oGtz6ue8G7nhMWnBSfdpGmLYPNXdNO7xpUu3u2csPi0YGZOI3vBzOwIMzt5s2tC49OCmZknTYInWgS/ToNgEqgRzBwzmwQP7GdzFA2C5Y+N4JDXaPpqCAgmCxvBPXUrN3duYRQ8qdGuOyCYEGwEn84IbPnei0bB+1KDroFgQG6AYMIBwYQDggkHBBMOCCYcEEw4IJhwQDDhgGDCAcGEA4IJBwQTDggmHBBMOCCYcEAw4YBgwgHBhAOCCQcEEw4IJhwQTDggmHBAMOH8PzCVPVa437tGAAAAAElFTkSuQmCC" /><!-- --></p>
<p>If we want we can specify the value of the sensivity parameter <code>gamma</code> specificaly instead of choosing it based upon the <code>data_type</code>. For example,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dc &lt;-<span class="st"> </span><span class="kw">deconv</span>(Y,pure_samples,n_choose,<span class="dt">gamma=</span>.<span class="dv">7</span>,<span class="dt">full_markers=</span>marks)
phats &lt;-<span class="st"> </span>dc$estimates
<span class="kw">plot</span>(rat.truth,phats,<span class="dt">xlab=</span><span class="st">&quot;Truth&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Estimates&quot;</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))
<span class="kw">abline</span>(<span class="dt">coef=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can view the pre-selected values for <code>gamma</code> from the function <code>get_gamma</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">get_gamma</span>(<span class="st">'microarray-probe'</span>)</code></pre></div>
<pre><code>## [1] 0.9387038</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">get_gamma</span>(<span class="st">'microarray-gene'</span>)</code></pre></div>
<pre><code>## [1] 0.9902935</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">get_gamma</span>(<span class="st">'rna-seq'</span>)</code></pre></div>
<pre><code>## [1] 1</code></pre>
<p>There are a lot of arguments that can be supplied to the deconvolution function if desired. The three most important arguments are n_choose, full_markers and gamma. Instead of letting deconv adaptively compute these we can specify them in advance. Often it is useful to pre-compute the markers which allows us to test different values of the other arguemnts.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">marker_list =<span class="st"> </span><span class="kw">find_markers</span>(Y,pure_samples)
marks =<span class="st"> </span>marker_list$L
dc &lt;-<span class="st"> </span><span class="kw">deconv</span>(Y, pure_samples, <span class="dt">n_choose =</span> <span class="kw">c</span>(<span class="dv">100</span>,<span class="dv">101</span>,<span class="dv">102</span>), <span class="dt">gamma=</span>.<span class="dv">6</span>, <span class="dt">full_markers =</span> marks)
phats &lt;-<span class="st"> </span>dc$estimates
<span class="kw">head</span>(phats)
dc &lt;-<span class="st"> </span><span class="kw">deconv</span>(Y, pure_samples, <span class="dt">n_choose =</span> <span class="dv">50</span>, <span class="dt">gamma =</span> <span class="dv">1</span>, <span class="dt">full_markers =</span> marks)
phats &lt;-<span class="st"> </span>dc$estimates
<span class="kw">head</span>(phats)</code></pre></div>
<p>One useful way to choose the number of markers is to threshold the value of the marker ranking algorithm.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">thresh =<span class="st"> </span>.<span class="dv">01</span>
K =<span class="st"> </span><span class="kw">length</span>(pure_samples)
n_choose =<span class="st"> </span><span class="kw">sapply</span>(<span class="dv">1</span>:K,function(i){<span class="kw">max</span>(<span class="kw">which</span>(marker_list$V[[i]] &gt;<span class="st"> </span>(-thresh)))})</code></pre></div>
<p>Doing this in advance often allows us to play with parameters without having to recompute them each time.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dc &lt;-<span class="st"> </span><span class="kw">deconv</span>(Y, pure_samples,n_choose,marks,<span class="dt">gamma=</span><span class="fl">1.1</span>)
phats &lt;-<span class="st"> </span>dc$estimates
<span class="kw">plot</span>(rat.truth,phats,<span class="dt">xlab=</span><span class="st">&quot;Truth&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Estimates&quot;</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))
<span class="kw">abline</span>(<span class="dt">coef=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))
dc2 &lt;-<span class="st"> </span><span class="kw">deconv</span>(Y, pure_samples,n_choose,marks,<span class="dt">gamma=</span>.<span class="dv">7</span>)
phats2 &lt;-<span class="st"> </span>dc2$estimates
<span class="kw">points</span>(rat.truth,phats2,<span class="dt">col=</span><span class="st">'blue'</span>)
dc3 &lt;-<span class="st"> </span><span class="kw">deconv</span>(Y, pure_samples,<span class="dv">200</span>,marks,<span class="dt">gamma=</span>.<span class="dv">5</span>)
phats3 &lt;-<span class="st"> </span>dc3$estimates
<span class="kw">points</span>(rat.truth,phats3,<span class="dt">col=</span><span class="st">'red'</span>)</code></pre></div>
<p>We can test different methods of choosing markers by specifying the <code>marker_method</code> argument.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">marker_list =<span class="st"> </span><span class="kw">find_markers</span>(Y,pure_samples)
marks =<span class="st"> </span>marker_list$L
thresh =<span class="st"> </span>.<span class="dv">01</span>
K =<span class="st"> </span><span class="kw">length</span>(pure_samples)
n_choose =<span class="st"> </span><span class="kw">sapply</span>(<span class="dv">1</span>:K,function(i){<span class="kw">max</span>(<span class="kw">which</span>(marker_list$V[[i]] &gt;<span class="st"> </span>(-thresh)))})

dc &lt;-<span class="st"> </span><span class="kw">deconv</span>(Y, pure_samples,<span class="dt">gamma=</span><span class="st">'microarray-probe'</span>,n_choose,<span class="dt">marker_method =</span> <span class="st">'eta'</span>)
phats &lt;-<span class="st"> </span>dc$estimates
<span class="kw">plot</span>(rat.truth,phats,<span class="dt">xlab=</span><span class="st">&quot;Truth&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Estimates&quot;</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))
<span class="kw">abline</span>(<span class="dt">coef=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))

dc &lt;-<span class="st"> </span><span class="kw">deconv</span>(Y, pure_samples,n_choose,<span class="dt">marker_method =</span> <span class="st">'diff'</span>,<span class="dt">gamma=</span><span class="st">'microarray-probe'</span>)
phats2 &lt;-<span class="st"> </span>dc2$estimates
<span class="kw">points</span>(rat.truth,phats2,<span class="dt">col=</span><span class="st">'blue'</span>)

dc3 &lt;-<span class="st"> </span><span class="kw">deconv</span>(Y, pure_samples,n_choose,<span class="dt">marker_method=</span><span class="st">'regression'</span>,<span class="dt">gamma=</span><span class="st">'microarray-probe'</span>)
phats3 &lt;-<span class="st"> </span>dc3$estimates
<span class="kw">points</span>(rat.truth,phats3,<span class="dt">col=</span><span class="st">'red'</span>)</code></pre></div>
<p>We can also run the algorithm on RMA summarized expressions.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Y &lt;-<span class="st"> </span><span class="kw">data.frame</span>(affy::<span class="kw">rma</span>(rat,<span class="dt">verbose=</span><span class="ot">FALSE</span>))

dc &lt;-<span class="st"> </span><span class="kw">deconv</span>(Y, pure_samples,<span class="dt">gamma=</span><span class="st">&quot;microarray-gene&quot;</span>)
phats &lt;-<span class="st"> </span>dc$estimates</code></pre></div>
<p>We plot the estimated mixing proportions against the truth.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(rat.truth,phats,<span class="dt">xlab=</span><span class="st">&quot;Truth&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Estimates&quot;</span>)
<span class="kw">abline</span>(<span class="dt">coef=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</code></pre></div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
