<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Greg Hunt" />

<meta name="date" content="2019-11-29" />

<title>Basic Deconvolution using dtangle</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Basic Deconvolution using dtangle</h1>
<h4 class="author">Greg Hunt</h4>
<h4 class="date">2019-11-29</h4>



<div id="the-data" class="section level1">
<h1>The Data</h1>
<p>In this vignette we will work through a simple example of deconvolving cell type proportions from DNA microarray data. We work with a data set created from rats and introduced by <a href="https://www.nature.com/nmeth/journal/v7/n4/abs/nmeth.1439.html">Shen-Orr et al</a>. This is available on GEO with accession <a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE19830">GSE19830</a>. The data set we will work with is a subset of the Shen-Orr data and is included in the <code>dtangle</code> package under the name <code>shen_orr_ex</code>. Alternatively, we can access this data set and other data sets through the supplementary <code>dtangle.data</code> package we have made available <a href="https://umich.box.com/v/dtangledatapkg">here</a>. More information about the data set is available as part of the <code>R</code> help, <code>?shen_orr_ex</code>. First, load up the data set.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">'dtangle'</span>)
<span class="kw">names</span>(shen_orr_ex)</code></pre></div>
<pre><code>## [1] &quot;data&quot;       &quot;annotation&quot; &quot;name&quot;</code></pre>
<p>In this data set, rat brain, liver and lung cells have been mixed together in various proportions. The resulting mixtures were analyzed with DNA microarrays. The mixing proportions are encoded in the mixture matrix</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(shen_orr_ex<span class="op">$</span>annotation<span class="op">$</span>mixture)</code></pre></div>
<pre><code>##           Liver Brain Lung
## GSM495209     1     0    0
## GSM495210     1     0    0
## GSM495211     1     0    0
## GSM495212     0     1    0
## GSM495213     0     1    0
## GSM495214     0     1    0</code></pre>
<p>Each row of this matrix is a sample and each column gives the mixing proportions of the cell types in each sample.</p>
<p>The RMA-summarized gene expression data generated as part of the Shen-Orr experiment is accessible under <code>data$log</code>,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Y &lt;-<span class="st"> </span>shen_orr_ex<span class="op">$</span>data<span class="op">$</span>log
Y[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>]</code></pre></div>
<pre><code>##           X1367566_at X1367568_a_at X1367570_at X1367584_at
## GSM495209    3.396192      7.685769    5.722330    6.628653
## GSM495210    2.882626      7.759002    6.005583    6.771917
## GSM495211    3.072980      7.598871    5.741630    6.564820
## GSM495212    3.168440      7.209959    6.396841    7.040779</code></pre>
<p>Each row is a different individual and each column is a particular gene. The values of the matrix are <span class="math inline">\(\log_2\)</span> RMA-summarized gene expressions.</p>
</div>
<div id="arguments" class="section level1">
<h1>Arguments</h1>
<p>The arguments to dtangle can be grouped as follows. First are the the two most important groups of arguments:</p>
<ol style="list-style-type: decimal">
<li>gene expression data input: Y, references, and pure_samples</li>
<li>marker gene controls: n_markers, markers and marker_method</li>
</ol>
<p>and then the less important arguments for more fine-tuned control:</p>
<ol start="3" style="list-style-type: decimal">
<li>data type fudge-factor controls: gamma and data_type</li>
<li>the summarizing function: summary_fn</li>
</ol>
</div>
<div id="y-references-and-pure_samples" class="section level1">
<h1>1. Y, references, and pure_samples</h1>
<p>In order to deconvolve gene expression data from mixture samples dtangle requires references of the cell-types to be deconvolved. The mixture gene expressions and reference gene expressions are given to dtangle using the arguments Y, references, and pure_samples.</p>
<p>Here we use some data from <a href="https://www.nature.com/nmeth/journal/v7/n4/abs/nmeth.1439.html">Shen-Orr et al</a> as an example. This data consists of log-scale expression measurements from mixtures of rat brain, liver and lung cells.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">'dtangle'</span>)
data =<span class="st"> </span>shen_orr_ex<span class="op">$</span>data<span class="op">$</span>log
mixture_proportions =<span class="st"> </span>shen_orr_ex<span class="op">$</span>annotation<span class="op">$</span>mixture</code></pre></div>
<p>the true mixing proportion of each sample captured in the variable mixture_proportions:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mixture_proportions</code></pre></div>
<pre><code>##           Liver Brain Lung
## GSM495209  1.00  0.00 0.00
## GSM495210  1.00  0.00 0.00
## GSM495211  1.00  0.00 0.00
## GSM495212  0.00  1.00 0.00
## GSM495213  0.00  1.00 0.00
## GSM495214  0.00  1.00 0.00
## GSM495215  0.00  0.00 1.00
## GSM495216  0.00  0.00 1.00
## GSM495217  0.00  0.00 1.00
## GSM495218  0.05  0.25 0.70
## GSM495219  0.05  0.25 0.70
## GSM495220  0.05  0.25 0.70
## GSM495221  0.70  0.05 0.25
## GSM495222  0.70  0.05 0.25
## GSM495223  0.70  0.05 0.25
## GSM495224  0.25  0.70 0.05
## GSM495225  0.25  0.70 0.05
## GSM495226  0.25  0.70 0.05
## GSM495227  0.70  0.25 0.05
## GSM495228  0.70  0.25 0.05
## GSM495229  0.70  0.25 0.05
## GSM495230  0.45  0.45 0.10
## GSM495231  0.45  0.45 0.10
## GSM495232  0.45  0.45 0.10
## GSM495233  0.55  0.20 0.25
## GSM495234  0.55  0.20 0.25
## GSM495235  0.55  0.20 0.25
## GSM495236  0.50  0.30 0.20
## GSM495237  0.50  0.30 0.20
## GSM495238  0.50  0.30 0.20
## GSM495239  0.55  0.30 0.15
## GSM495240  0.55  0.30 0.15
## GSM495241  0.55  0.30 0.15
## GSM495242  0.50  0.40 0.10
## GSM495243  0.50  0.40 0.10
## GSM495244  0.50  0.40 0.10
## GSM495245  0.60  0.35 0.05
## GSM495246  0.60  0.35 0.05
## GSM495247  0.60  0.35 0.05
## GSM495248  0.65  0.34 0.01
## GSM495249  0.65  0.34 0.01
## GSM495250  0.65  0.34 0.01</code></pre>
<p>we can see from this that the first nine samples are pure reference samples of the three cell types and the remaining samples are mixture samples of the cell types. We want to use these reference samples to deconvolve the remaining mixture samples. This can be done in a couple of ways:</p>
<ol style="list-style-type: decimal">
<li>We can provide Y and pure_samples to dtangle. Here Y will be the combined matrix of reference and mixture samples and pure_samples will tell dtangle which samples (rows of Y) are reference samples and (by elimination) which samples are mixture samples we wish to deconvolve.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pure_samples =<span class="st"> </span><span class="kw">list</span>(<span class="dt">Liver=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),<span class="dt">Brain=</span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>),<span class="dt">Lung=</span><span class="kw">c</span>(<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>))

dt_out =<span class="st"> </span><span class="kw">dtangle</span>(<span class="dt">Y=</span>data, <span class="dt">pure_samples =</span> pure_samples)

<span class="kw">matplot</span>(mixture_proportions,dt_out<span class="op">$</span>estimates, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">xlab=</span><span class="st">&quot;Truth&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Estimates&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<ol start="2" style="list-style-type: decimal">
<li>We can instead split the data into Y as just the matrix of mixture samples and references as the matrix of reference expressions.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mixture_samples =<span class="st"> </span>data[<span class="op">-</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">9</span>),]
reference_samples =<span class="st"> </span>data[<span class="dv">1</span><span class="op">:</span><span class="dv">9</span>,]

dt_out =<span class="st"> </span><span class="kw">dtangle</span>(<span class="dt">Y=</span>mixture_samples, <span class="dt">reference=</span>reference_samples,<span class="dt">pure_samples =</span> pure_samples)

mixture_mixture_proportions =<span class="st"> </span>mixture_proportions[<span class="op">-</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">9</span>),]
<span class="kw">matplot</span>(mixture_mixture_proportions,dt_out<span class="op">$</span>estimates, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">xlab=</span><span class="st">&quot;Truth&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Estimates&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Now the variable pure_samples tells dtangle what cell type each of the the rows of the references matrix corresponds to. Notice that dtangle only estimates the mixing proportions for the samples given in the Y argument and so since we have removed the references samples from the matrix passed to Y then we only estimate the mixing proportions for the remaining 33 mixture samples. Previously we had estimated proportions for both the mixture and reference samples.</p>
<p>In this example we still needed the variable pure_samples because our reference expression matrix contained multiple reference profiles for each cell type. Often one only has a reference expression matrix with one (typically average) expression profile per cell type. In this case we donâ€™t need the pure_samples argument:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ref_reduced =<span class="st"> </span><span class="kw">t</span>(<span class="kw">sapply</span>(pure_samples,<span class="cf">function</span>(x)<span class="kw">colMeans</span>(reference_samples[x,,<span class="dt">drop=</span><span class="ot">FALSE</span>])))

dt_out =<span class="st"> </span><span class="kw">dtangle</span>(<span class="dt">Y=</span>mixture_samples, <span class="dt">reference=</span>ref_reduced)

<span class="kw">matplot</span>(mixture_mixture_proportions,dt_out<span class="op">$</span>estimates, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">xlab=</span><span class="st">&quot;Truth&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Estimates&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="n_markers-markers-and-marker_method" class="section level1">
<h1>2. n_markers, markers and marker_method</h1>
<p>Central to dtangle is finding marker genes for each cell type. Markers may either be given explicitly to dtangle by the user or they may be left up to dtangle itself to determine the marker genes automatically.</p>
<div id="letting-dtangle-determine-the-marker-genes." class="section level2">
<h2>Letting dtangle determine the marker genes.</h2>
<p>If we do not specify the argument markers then dtangle automatically determines marker genes:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dt_out =<span class="st"> </span><span class="kw">dtangle</span>(<span class="dt">Y=</span>mixture_samples, <span class="dt">references =</span> ref_reduced)</code></pre></div>
<p>we can change the way that dtangle finds marker genes using the marker_method argument:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dt_out =<span class="st"> </span><span class="kw">dtangle</span>(<span class="dt">Y=</span>mixture_samples, <span class="dt">references =</span> ref_reduced,<span class="dt">marker_method =</span> <span class="st">&quot;diff&quot;</span>)</code></pre></div>
<p>the default is to use â€œratioâ€.</p>
<p>The argument n_markers specifies how many marker genes to use. If unspecified then dtangle uses the top 10% of genes (as ranked according to marker_method) as markers.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dt_out<span class="op">$</span>n_markers</code></pre></div>
<pre><code>## Liver Brain  Lung 
##    20    20    20</code></pre>
<p>The number of marker genes can be explicitly specified by setting n_markers:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dt_out =<span class="st"> </span><span class="kw">dtangle</span>(<span class="dt">Y=</span>mixture_samples, <span class="dt">references =</span> ref_reduced,<span class="dt">marker_method =</span> <span class="st">&quot;diff&quot;</span>,<span class="dt">n_markers=</span><span class="dv">100</span>)

dt_out<span class="op">$</span>n_markers</code></pre></div>
<pre><code>## [1] 100 100 100</code></pre>
<p>if just a single integer is specified then all genes use that number of marker genes. Alternatively we can specify a vector of integers to specify a number of marker genes individually for each cell type:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dt_out =<span class="st"> </span><span class="kw">dtangle</span>(<span class="dt">Y=</span>mixture_samples, <span class="dt">references =</span> ref_reduced,<span class="dt">marker_method =</span> <span class="st">&quot;diff&quot;</span>,<span class="dt">n_markers=</span><span class="kw">c</span>(<span class="dv">100</span>,<span class="dv">150</span>,<span class="dv">50</span>))

dt_out<span class="op">$</span>n_markers</code></pre></div>
<pre><code>## [1] 100 150  50</code></pre>
<p>we can also, in a similar fashion, pass a percentage (or vector of percentages) to n_markers which will then use that percentage of the ranked marker genes for each cell type:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dt_out =<span class="st"> </span><span class="kw">dtangle</span>(<span class="dt">Y=</span>mixture_samples, <span class="dt">references =</span> ref_reduced,<span class="dt">marker_method =</span> <span class="st">&quot;diff&quot;</span>,<span class="dt">n_markers=</span>.<span class="dv">075</span>)

dt_out<span class="op">$</span>n_markers</code></pre></div>
<pre><code>## [1] 15 15 15</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dt_out =<span class="st"> </span><span class="kw">dtangle</span>(<span class="dt">Y=</span>mixture_samples, <span class="dt">references =</span> ref_reduced,<span class="dt">marker_method =</span> <span class="st">&quot;diff&quot;</span>,<span class="dt">n_markers=</span><span class="kw">c</span>(.<span class="dv">1</span>,.<span class="dv">15</span>,.<span class="dv">05</span>))

dt_out<span class="op">$</span>n_markers</code></pre></div>
<pre><code>## [1] 20 30 10</code></pre>
</div>
<div id="specifying-the-marker-genes-explicitly." class="section level2">
<h2>Specifying the marker genes explicitly.</h2>
<p>Instead of letting dtangle determine the marker genes we can instead explicitly pass a list of markers to dtangle specifying the marker genes,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">marker_genes =<span class="st"> </span><span class="kw">list</span>(<span class="kw">c</span>(<span class="dv">120</span>,<span class="dv">253</span>,<span class="dv">316</span>),
                    <span class="kw">c</span>(<span class="dv">180</span>,<span class="dv">429</span>,<span class="dv">14</span>),
                    <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">109</span>,<span class="dv">206</span>))

dt_out =<span class="st"> </span><span class="kw">dtangle</span>(<span class="dt">Y=</span>mixture_samples, <span class="dt">references =</span> ref_reduced,<span class="dt">markers=</span>marker_genes)
dt_out<span class="op">$</span>n_markers</code></pre></div>
<pre><code>## [1] 3 3 3</code></pre>
<p>the format of the list is precisely the same format as returned in the markers element of the output of dtangle, that is, a list of vectors of column indicies of <span class="math inline">\(Y\)</span> that are markers of each of the cell types. The elements of the list correspond one to each cell type in the same order specified either in elements of pure_samples or by the rows of references. The argument of n_markers can be used in the same way to subset the markers if desired.</p>
</div>
<div id="how-dtangle-finds-markers" class="section level2">
<h2>How dtangle finds markers</h2>
<p>dtangle finds the marker genes by using the find_markers function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mrkrs =<span class="st"> </span><span class="kw">find_markers</span>(<span class="dt">Y=</span>mixture_samples, <span class="dt">references =</span> ref_reduced)
<span class="kw">names</span>(mrkrs)</code></pre></div>
<pre><code>## [1] &quot;L&quot;  &quot;V&quot;  &quot;M&quot;  &quot;sM&quot;</code></pre>
<p>which returns a list with four elements: L which contains all genes putatively assigned to a cell type they mark, V which contains the ranking values by which the elements of L are ordered, M and sM which are the matrix and sorted matrix used to create V and L.</p>
<p>We can pass either the entire list or just the L list to dtangle as markers and re-create how dtangle automatically chooses markers:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dt_out =<span class="st"> </span><span class="kw">dtangle</span>(<span class="dt">Y =</span> mixture_samples,<span class="dt">references =</span> ref_reduced,<span class="dt">markers=</span>mrkrs,<span class="dt">n_markers=</span>.<span class="dv">1</span>)</code></pre></div>
</div>
</div>
<div id="gamma-and-data_type" class="section level1">
<h1>3. gamma and data_type</h1>
<p>A unique aspect of dtangle is its parameter <span class="math inline">\(\gamma\)</span>. This is a fudge factor dtangle applies to account for imperfect mRNA quantification, especially for microarrays. The value of <span class="math inline">\(\gamma\)</span> can be specified through the argument gamma or data_type.</p>
<p>We can explicitly set gamma if we want,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dt_out =<span class="st"> </span><span class="kw">dtangle</span>(<span class="dt">Y =</span> mixture_samples,<span class="dt">references =</span> ref_reduced,<span class="dt">gamma=</span>.<span class="dv">9</span>)</code></pre></div>
<p>or we can set it a pre-defined value by passing the data_type argument which sets <span class="math inline">\(\gamma\)</span> automatically based upon the data type:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dt_out =<span class="st"> </span><span class="kw">dtangle</span>(<span class="dt">Y =</span> mixture_samples,<span class="dt">references =</span> ref_reduced,<span class="dt">data_type=</span><span class="st">&quot;microarray-gene&quot;</span>)</code></pre></div>
<p>the options for <span class="math inline">\(\gamma\)</span> are</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dtangle<span class="op">:::</span>gma</code></pre></div>
<pre><code>## $ma_probe
## [1] 0.4522564
## 
## $ma_gene
## [1] 0.6999978
## 
## $rna_seq
## [1] 0.9433902</code></pre>
<p>if neither gamma nor data_type are specified then dtangle sets <span class="math inline">\(\gamma\)</span> to one. If there is no intuition about either the data type or a good value of <span class="math inline">\(\gamma\)</span> then we recommend leaving <span class="math inline">\(\gamma\)</span> at one.</p>
</div>
<div id="summary_fn" class="section level1">
<h1>4. summary_fn</h1>
<p>There is a final optional parameter summary_fn which controls how dtangle aggregates the gene expressions for estimation. dtangle is a very robust algorithm and so the default summary function is the mean. One can specify the median as a more robust option, or any other summary statistic if so they desire. We recommend either the mean or the median.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dt_out =<span class="st"> </span><span class="kw">dtangle</span>(<span class="dt">Y =</span> mixture_samples,<span class="dt">references =</span> ref_reduced,<span class="dt">summary_fn=</span>median)
<span class="kw">head</span>(dt_out<span class="op">$</span>estimates)</code></pre></div>
<pre><code>##                Liver      Brain      Lung
## GSM495218 0.05229139 0.29300675 0.6547019
## GSM495219 0.05505613 0.29357471 0.6513692
## GSM495220 0.05398451 0.29489946 0.6511160
## GSM495221 0.63900638 0.08046716 0.2805265
## GSM495222 0.63311391 0.08094852 0.2859376
## GSM495223 0.64332527 0.07615796 0.2805168</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dt_out =<span class="st"> </span><span class="kw">dtangle</span>(<span class="dt">Y =</span> mixture_samples,<span class="dt">references =</span> ref_reduced,<span class="dt">summary_fn=</span>mean)
<span class="kw">head</span>(dt_out<span class="op">$</span>estimates)</code></pre></div>
<pre><code>##                Liver      Brain      Lung
## GSM495218 0.04807655 0.30980298 0.6421205
## GSM495219 0.05213084 0.30896051 0.6389086
## GSM495220 0.05029034 0.30536233 0.6443473
## GSM495221 0.62007321 0.08564296 0.2942838
## GSM495222 0.61651390 0.08539553 0.2980906
## GSM495223 0.62319525 0.08137003 0.2954347</code></pre>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
